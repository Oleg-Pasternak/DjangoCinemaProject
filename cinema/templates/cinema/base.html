<!DOCTYPE html>
{% load staticfiles %}
<html lang='en'>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="theme-color" content="#121212">
  <meta name="msapplication-navbutton-color" content="#121212">
  <meta name="apple-mobile-web-app-status-bar-style" content="#121212">
  <link href="{% static 'cinema/css/main.css' %}" rel="stylesheet" type="text/css" media="screen"/>
  <link href="https://fonts.googleapis.com/css?family=Lobster|Oxygen" rel="stylesheet" >
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap-grid.min.css" integrity="sha256-vl+0p/Z28RcVvC+cofUiIeYusGdOc4CXk/taqgQ2/XU=" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hover.css/2.3.1/css/hover-min.css" integrity="sha256-c+C87jupO1otD1I5uyxV68WmSLCqtIoNlcHLXtzLCT0=" crossorigin="anonymous" />
  <title>{{ object.title }}</title>
</head>
<body>
  <div class="container-fluid" style="padding: 0px;">
    <header>
      <div class="row full" style="margin: 0px;">
        <div class="col centered" style="padding: 0px;">
          <div class="navbar-brand"><a href="/">Pasternak</a></div>
          <div class="search">
            {% csrf_token %}
            <input type="text" placeholder="Search" aria-lable="Search" id="search" name='cinema:search' value="">
          </div>
          <div class="navbar-logout">
            <a href="/logout">
              <img src="{% static 'cinema/img/exit.svg'%}" alt="">
            </a>
          </div>
        </div>
      </div>
    </header>
    <div class="row full" style="margin: 0px;">
      <div class="col centered">
          {% block main %}{% endblock main %}
          {% block sidebar %}{% endblock sidebar %}
      </div>
    </div>
    <div id="search_popup">
      <span id="search-results"></span>
    </div>
  </div>

  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
  <script src="{% static 'cinema/js/main.js' %}" type="text/javascript"></script>
  {% block domready %}{% endblock domready %}
  <!-- Search script -->
  <script type="text/javascript">
    function searchSuccess(data, textStatus, jqXHR) {
      console.log(data['result'].length)
      if (data['result'].length > 0) {
        $('#search-results').html( "<ul>" + "<a href=\"" + data["result"][0]["url"] + "\">" + data["result"][0]["title"] +  "</a>" + "</ul>");
      }
    }

    $(function() {
        $('#search').keyup(function() {
        if ($(this).val().length > 0) {
          $.ajax({
            type: "POST",
            url: '{% url "cinema:search" %}',
            data: {
                'search_text' : $(this).val(),
                'csrfmiddlewaretoken' : $("input[name=csrfmiddlewaretoken]").val(),
            },
            success: searchSuccess,
          });
        } else {
          $( '#search-results' ).html('');
        }
      });
    });
  </script>

</body>
</html>
